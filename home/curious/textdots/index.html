<!doctype html>
<html lang=en>

<head>
    <meta charset=utf-8>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>P5 Sketch</title>

    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            position: fixed;
            overflow: hidden;
        }

        #p5-container {
            height: 100%;
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        #input-hider {
            background-color: white;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        #hidden-input {
            position: absolute;
            top: 0;
            left: 0;
            z-index: -2;
        }

        #Keyboard__container {
            display: flex;
            width: 10vw;
            position: absolute;
            top: 3vw;
            right: 5vw;
            display: none;
            opacity: 0;
        }

        @media only screen and (min-width: 600px) {
            #Keyboard__container {
                width: 3vw;
            }
        }

        @media (hover: hover) and (pointer: fine) {
            #Keyboard__container.blink {
                display: block;
                animation: blinker 1s step-start infinite;
            }
        }

        @keyframes blinker {
            50% {
                opacity: 1;
            }
        }

        /* smartphones, touchscreens */
        @media (pointer: coarse) {
            #Keyboard__container {
                display: block;
                opacity: 1;
            }
        }

    </style>
    <script src="p5.min.js"></script>

</head>

<body>
    <div id="p5-container"></div>
    <textarea id="hidden-input"></textarea>
    <div id="input-hider"></div>
    <div id="Keyboard__container">
        <svg version="1.1" id="Keyboard" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
            <path fill="grey" d="M18.6,4H1.4C0.629,4,0,4.629,0,5.4v9.2C0,15.369,0.629,16,1.399,16h17.2c0.77,0,1.4-0.631,1.4-1.4V5.4
	C20,4.629,19.369,4,18.6,4z M11,6h2v2h-2V6z M14,9v2h-2V9H14z M8,6h2v2H8V6z M11,9v2H9V9H11z M5,6h2v2H5V6z M8,9v2H6V9H8z M2,6h2v2
	H2V6z M5,9v2H3V9H5z M4,14H2v-2h2V14z M15,14H5v-2h10V14z M18,14h-2v-2h2V14z M15,11V9h2v2H15z M18,8h-4V6h4V8z"></path>
        </svg>
    </div>
    <script>
        const container = document.querySelector('#p5-container')

        const input = document.querySelector('#hidden-input')

        let lastinput = ""

        input.addEventListener('input', (e) => {

            const str = e.target.value;

            let key = str.substring(lastinput.length, str.length);

            if (key == '\n') {
                key = 'Enter'
            }

            if (key.length === 1 || key === 'Enter') {
                const event = new CustomEvent('mobileKeyPressed', {
                    detail: {
                        key
                    }
                });

                container.dispatchEvent(event)

            }


            lastinput = str
        })


    </script>
    <script src="paths.js"></script>
    <script src="sketch.js"></script>
</body>

</html>
